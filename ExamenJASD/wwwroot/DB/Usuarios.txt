CREATE DATABASE ExamenEY;
USE ExamenEY;
GO

CREATE TABLE EY_USUARIOS(
EY_ID INT IDENTITY(1,1) PRIMARY KEY,
EY_NOMBRE_COMPLETO NVARCHAR(250),
EY_USUARIO NVARCHAR(50),
EY_PASSWORD NVARCHAR(256),
EY_EMAIL NVARCHAR(250),
EY_ESTATUS VARCHAR(15),
EY_FECHA_ALTA DATETIME,
EY_FECHA_MODIFICACION DATETIME
);


CREATE PROCEDURE SP_INSERTAR_USUARIO
@EY_NOMBRE_COMPLETO NVARCHAR(250),
@EY_USUARIO NVARCHAR(50),
@EY_PASSWORD NVARCHAR(256),
@EY_EMAIL NVARCHAR(250),
@EY_ESTATUS VARCHAR(15),
@EY_FECHA_ALTA DATETIME,
@EY_FECHA_MODIFICACION DATETIME
AS BEGIN
SET NOCOUNT ON
INSERT INTO EY_USUARIOS VALUES(@EY_NOMBRE_COMPLETO,@EY_USUARIO,@EY_PASSWORD,@EY_EMAIL,@EY_ESTATUS,@EY_FECHA_ALTA,@EY_FECHA_MODIFICACION)
END;

CREATE PROCEDURE SP_ACTUALIZAR_USUARIO
@EY_NOMBRE_COMPLETO NVARCHAR(250),
@EY_USUARIO NVARCHAR(50),
@EY_PASSWORD NVARCHAR(256),
@EY_EMAIL NVARCHAR(250),
@EY_ESTATUS VARCHAR(15),
@EY_FECHA_MODIFICACION DATETIME
AS BEGIN
SET NOCOUNT ON
UPDATE
	EY_USUARIOS
SET
	EY_NOMBRE_COMPLETO = ISNULL(@EY_NOMBRE_COMPLETO,EY_NOMBRE_COMPLETO),
	EY_PASSWORD = ISNULL(@EY_PASSWORD,EY_PASSWORD),
	EY_EMAIL = ISNULL(@EY_EMAIL,EY_EMAIL),
	EY_ESTATUS = ISNULL(@EY_ESTATUS,EY_ESTATUS),
	EY_FECHA_MODIFICACION = ISNULL(@EY_FECHA_MODIFICACION,EY_FECHA_MODIFICACION)
WHERE
	EY_USUARIO = @EY_USUARIO
END;

CREATE PROCEDURE SP_LISTA_USUARIOS
AS BEGIN
SET NOCOUNT ON
SELECT
	*
FROM
	EY_USUARIOS
END;

CREATE PROCEDURE SP_LISTA_USUARIOS_ID
@EY_ID INT
AS BEGIN
SET NOCOUNT ON
SELECT
	*
FROM
	EY_USUARIOS
WHERE
	EY_USUARIOS.EY_ID = @EY_ID
END;

CREATE PROCEDURE SP_OBTENER_USUARIO
	@EY_USUARIO NVARCHAR(50)
AS BEGIN
SET NOCOUNT ON
SELECT
	EY_USUARIO,
	EY_PASSWORD
FROM
	EY_USUARIOS
WHERE
		EY_USUARIO = @EY_USUARIO 
END;


